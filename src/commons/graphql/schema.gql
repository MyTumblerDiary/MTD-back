# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

"""가맹점 Entity"""
type Franchise {
  id: String!
  createdAt: String!
  updatedAt: String
  deletedAt: String

  """가맹점 이름입니다. """
  name: String!

  """가맹점 텀블러 할인 금액입니다. """
  discountPrice: Int

  """가맹점에 속한 가게들입니다. """
  stores: [Store!]
}

"""가게 Entity"""
type Store {
  id: String!
  createdAt: String!
  updatedAt: String
  deletedAt: String

  """가게 이름입니다. """
  name: String!

  """해당 가게에서의 텀블러 할인 가격입니다. """
  discountPrice: Int!

  """가게의 도로명 주소입니다. """
  streetNameAddress: String!

  """가게의 지번 주소입니다. """
  lotNumberAddress: String!

  """가게의 상세 주소입니다. """
  detailAddress: String!

  """가게의 위도입니다. """
  latitude: Float!

  """가게의 경도입니다. """
  longitude: Float!

  """AWS S3 버킷에 저장되는 가게의 대표 이미지 파일키 입니다. """
  imageFileKey: String

  """가게의 텀블러 기록들입니다. """
  tumblerRecords: [TumblerRecord!]

  """가게가 속한 프랜차이즈입니다. """
  franchise: Franchise
}

"""텀블러 기록 Entity"""
type TumblerRecord {
  id: String!
  createdAt: String!
  updatedAt: String
  deletedAt: String

  """텀블러 할인 금액"""
  prices: Int

  """텀블러 기록 메모"""
  memo: String

  """텀블러 이미지 파일 키"""
  imageFileKey: String

  """텀블러를 사용한 날짜입니다. 양식은 YYYY-MM-DD입니다. """
  usedAt: String!

  """텀블러를 사용한 장소의 타입입니다. """
  placeType: String

  """텀블러 기록을 가진 유저"""
  user: User!

  """텀블러를 사용한 매장"""
  store: Store
}

"""유저 Entity"""
type User {
  id: String!
  createdAt: String!
  updatedAt: String
  deletedAt: String

  """이메일"""
  email: String!

  """비밀번호입니다. """
  password: String

  """닉네임은 최대 20자까지만 가능합니다. """
  nickname: String

  """local, google, kakao, apple 중 하나입니다. """
  social: String!

  """유저가 가지고 있는 텀블러 기록들입니다. """
  tumblerRecords: [TumblerRecord!]
}

type LoginResponseDto {
  accessToken: String!
  refreshToken: String!
}

type S3PresignedUrlOutput {
  presignedUrl: String!
  fileKey: String!
}

type StoresOutput {
  """가게 목록"""
  stores: [Store!]!

  """가게 목록의 총 개수"""
  totalCount: Int!

  """검색된 가게 목록의 총 페이지 수(검색하지 않으면 총 페이지 수)"""
  pagesCount: Int!

  """검색된 가게의 수"""
  searchedCount: Int!

  """현재 페이지"""
  currentPage: Int!
}

type TumblerRecordsOutput {
  """유저의 모든 텀블러 기록을 가져옵니다."""
  tumblerRecords: [TumblerRecord!]!

  """유저가 지금까지 할인 받은 총 금액을 가져옵니다."""
  totalDiscount: Float!

  """유저의 텀블러 기록 개수를 가져옵니다."""
  totalUsedTumbler: Float!

  """검색 필터를 적용한 텀블러 기록의 개수를 가져옵니다."""
  filteredTumbler: Float

  """검색 필터를 적용한 텀블러 기록의 총 할인 금액을 가져옵니다."""
  filteredDiscount: Float
}

type Query {
  """중복 이메일 확인"""
  checkEmail(email: String!): Boolean!

  """닉네임 중복 확인"""
  checkNickname(nickname: String!): Boolean!

  """유저 정보 가져오기"""
  user: User!

  """Find all stores"""
  stores(paginationInput: PaginationInput, searchStoreInput: SearchStoreInput, orderStoreInput: OrderStoreInput): StoresOutput!

  """Find one store by id"""
  store(id: String!): Store!

  """모든 프렌차이즈를 조회합니다. """
  franchises: [Franchise!]!

  """id로 하나의 프렌차이즈를 조회합니다. """
  franchise(id: String!): Franchise!

  """검색 조건에 맞는 프렌차이즈를 조회합니다. """
  franchisesBySearch(searchInput: SearchInput!): [Franchise!]!

  """
  유저의 모든 텀블러 사용 기록과 누적 할인 금액, 할인 횟수를 가져옵니다.
      이때, 검색 필터를 적용하면 검색된 텀블러 기록만 가져옵니다. 
  """
  tumblerRecords(searchTumblerRecordInput: SearchTumblerRecordInput): TumblerRecordsOutput!

  """유저가 가장 많이 방문한 공간을 순위대로 가져옵니다."""
  mostVisitedStores(limit: Float = 1): [Store!]!

  """텀블러 기록을 하나 가져옵니다."""
  tumblerRecord(id: String!): TumblerRecord!

  """이메일 인증코드 보내기"""
  createUserEmail(email: String!): String!

  """이메일인증 코드 확인"""
  checkcode(email: String!, code: String!): Boolean!

  """비밀번호 재설정 이메일 보내기"""
  resetPasswordEmail(email: String!): String!
}

input PaginationInput {
  page: Float! = 1
  limit: Float! = 10
}

input SearchStoreInput {
  """가게에서 검색할 기준 필드를 선택합니다. """
  searchBy: StoreField = NAME

  """검색할 값입니다. """
  value: String = ""

  """정렬 방식입니다. """
  order: OrderDirection = DESC
}

"""Store Entity에 포함된 필드입니다."""
enum StoreField {
  ID
  NAME
  DISCOUNT_PRICE
  STREET_NAME_ADDRESS
  LOT_NUMBER_ADDRESS
  DETAIL_ADDRESS
  LATITUDE
  LONGITUDE
  IMAGE_FILE_KEY
}

"""Order direction"""
enum OrderDirection {
  ASC
  DESC
}

input OrderStoreInput {
  orderBy: StoreField = NAME
  orderDirection: OrderDirection = DESC
}

input SearchInput {
  """검색할 필드입니다. """
  searchBy: String = "id"

  """검색할 값입니다. """
  value: String = ""

  """정렬 방식입니다. """
  order: OrderDirection = DESC
}

input SearchTumblerRecordInput {
  """검색할 필드입니다. TumblerRecord Entity에 포함된 필드만 검색 가능합니다."""
  searchBy: String = "id"

  """검색할 값입니다. """
  value: String = ""

  """정렬 방식입니다. """
  order: OrderDirection = DESC
}

type Mutation {
  """회원가입"""
  createUser(createUserInput: CreateUserInput!): User!

  """유저정보 수정"""
  updateUser(updateUserInput: UpdateUserInput!): User!

  """유저정보 삭제"""
  deleteUser: Boolean!

  """이메일 인증후 비밀번호 수정하기"""
  resetPassword(userEmail: String!, password: String!): User!

  """로컬 로그인"""
  login(loginInput: LoginInputDto!): LoginResponseDto!

  """accesstoken 재발급"""
  restoreAccessToken: String!

  """인가코드로 카카오 accesstoken 발급후 로그인"""
  kakaoLogin(code: String!): LoginResponseDto!

  """인가코드로 구글 accesstoken 발급후 로그인"""
  googleLogin(code: String!): LoginResponseDto!

  """apple 인가코드로 accesstoken 발급"""
  appleLogin(code: String!): LoginResponseDto!

  """로그아웃"""
  logout: String!

  """Create a store"""
  createStore(createStoreInput: CreateStoreInput!): Store!

  """Update a store"""
  updateStore(updateStoreInput: UpdateStoreInput!): Store!

  """Delete a store"""
  deleteStore(id: String!): Boolean!

  """프렌차이즈를 생성합니다. """
  createFranchise(createFranhiseInput: CreateFranchiseInput!): Franchise!

  """프렌차이즈를 수정합니다. """
  updateFranchise(id: String!, updateFranchiseInput: UpdateFranchiseInput!): Franchise!

  """프렌차이즈를 삭제합니다. """
  deleteFranchise(id: String!): Franchise!

  """Presigned URL을 받습니다."""
  getPresignedUrl(presignedUrlInput: S3PresignedUrlInput!): S3PresignedUrlOutput!

  """이미 존재하는 공간에 대한 텀블러 기록을 생성합니다. """
  createTumblerRecordWithStoreId(input: CreateTumblerRecordInput!): TumblerRecord!

  """새로운 공간에 대한 텀블러 기록을 생성합니다. """
  createTumblerRecordWithCreateStore(input: CreateTumblerRecordWithCreateStoreInput!): TumblerRecord!

  """개인 공간에서의 텀블러 기록을 생성합니다. """
  createTumblerRecordOnPrivateSpace(input: CreateTumblerRecordOnPrivateSpaceInput!): TumblerRecord!

  """텀블러 기록을 수정합니다."""
  updateTumblerRecord(id: String!, updateTumblerRecordInput: CreateTumblerRecordInput!): Boolean!

  """텀블러 기록을 삭제합니다."""
  deleteTumblerRecord(id: String!): Boolean!
}

input CreateUserInput {
  """이메일"""
  email: String

  """비밀번호입니다. """
  password: String

  """닉네임은 최대 20자까지만 가능합니다. """
  nickname: String

  """local, google, kakao, apple 중 하나입니다. """
  social: String
}

input UpdateUserInput {
  """비밀번호입니다. """
  password: String

  """닉네임은 최대 20자까지만 가능합니다. """
  nickname: String
  currentPassword: String
}

input LoginInputDto {
  email: String!
  password: String!
}

input CreateStoreInput {
  """가게 이름입니다. """
  name: String!

  """해당 가게에서의 텀블러 할인 가격입니다. """
  discountPrice: Int!

  """가게의 도로명 주소입니다. """
  streetNameAddress: String!

  """가게의 지번 주소입니다. """
  lotNumberAddress: String!

  """가게의 상세 주소입니다. """
  detailAddress: String!

  """가게의 위도입니다. """
  latitude: Float!

  """가게의 경도입니다. """
  longitude: Float!

  """AWS S3 버킷에 저장되는 가게의 대표 이미지 파일키 입니다. """
  imageFileKey: String

  """프랜차이즈 id입니다. 프랜차이즈라면 해당 id를 넣어주세요. """
  franchiseId: String
}

input UpdateStoreInput {
  """가게 이름입니다. """
  name: String

  """해당 가게에서의 텀블러 할인 가격입니다. """
  discountPrice: Int

  """가게의 도로명 주소입니다. """
  streetNameAddress: String

  """가게의 지번 주소입니다. """
  lotNumberAddress: String

  """가게의 상세 주소입니다. """
  detailAddress: String

  """가게의 위도입니다. """
  latitude: Float

  """가게의 경도입니다. """
  longitude: Float

  """AWS S3 버킷에 저장되는 가게의 대표 이미지 파일키 입니다. """
  imageFileKey: String

  """프랜차이즈 id입니다. 프랜차이즈라면 해당 id를 넣어주세요. """
  franchiseId: String
}

input CreateFranchiseInput {
  """가맹점 이름입니다. """
  name: String!

  """가맹점 텀블러 할인 금액입니다. """
  discountPrice: Int
}

input UpdateFranchiseInput {
  """가맹점 이름입니다. """
  name: String

  """가맹점 텀블러 할인 금액입니다. """
  discountPrice: Int
}

input S3PresignedUrlInput {
  fileName: String!
  type: ImageType!
}

"""이미지 타입"""
enum ImageType {
  JPG
  PNG
  GIF
  WEBP
  SVG
  TIFF
  BMP
  ICO
}

input CreateTumblerRecordInput {
  """텀블러 할인 금액"""
  prices: Int

  """텀블러 기록 메모"""
  memo: String

  """텀블러 이미지 파일 키"""
  imageFileKey: String

  """텀블러를 사용한 날짜입니다. 양식은 YYYY-MM-DD입니다. """
  usedAt: String

  """텀블러를 사용한 가게입니다. """
  storeId: String
}

input CreateTumblerRecordWithCreateStoreInput {
  """텀블러 기록을 생성을 위한 Input data입니다. """
  createTumblerRecordInput: CreateTumblerRecordInput!

  """공간 생성을 위한 Input data입니다. """
  createStoreInput: CreateStoreInput!
}

"""새로운 공간에 대한 텀블러 기록을 생성할 때 사용되는 Input Type"""
input CreateTumblerRecordOnPrivateSpaceInput {
  """텀블러 기록 메모"""
  memo: String

  """텀블러 이미지 파일 키"""
  imageFileKey: String

  """텀블러를 사용한 날짜입니다. 양식은 YYYY-MM-DD입니다. """
  usedAt: String!

  """텀블러를 사용한 장소의 타입입니다. """
  placeType: String
}